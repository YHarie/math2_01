<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>二項定理クイズ</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    .question { margin-bottom: 1.5em; }
    code { font-size: 1.2em; background: #f0f0f0; padding: 4px 8px; border-radius: 5px; display: inline-block; }
  </style>
</head>
<body>
  <h1>二項定理の係数を求める問題</h1>
  <div id="questions"></div>
  <button onclick="generateQuestions()">再出題</button>

  <script>
    function gcd(a, b) {
      while (b !== 0) {
        [a, b] = [b, a % b];
      }
      return Math.abs(a);
    }

    function getCoprimePair() {
      const aCandidates = [2, 3, 4, 5];
      const bCandidates = [-3, -2, -1, 1, 2, 3];
      while (true) {
        const a = aCandidates[Math.floor(Math.random() * aCandidates.length)];
        const b = bCandidates[Math.floor(Math.random() * bCandidates.length)];
        if (gcd(a, Math.abs(b)) === 1) {
          return [a, b];
        }
      }
    }

    function formatTerm(a, b) {
      const aStr = a === 1 ? "" : a;
      let bStr;
      if (b > 0) {
        bStr = `+${b}`;
      } else {
        bStr = `${b}`;
      }
      return `(${aStr}x ${bStr})`;
    }

    function generateQuestions() {
      const container = document.getElementById("questions");
      container.innerHTML = "";

      for (let i = 0; i < 3; i++) {
        const [a, b] = getCoprimePair();
        const r = Math.floor(Math.random() * 3) + 3; // 3 <= r <= 5
        const k = Math.floor(Math.random() * (r - 1)) + 1; // 1 <= k <= r-1

        const term = formatTerm(a, b);
        const questionText = `${term}<sup>${r}</sup> の展開において、x<sup>${k}</sup> の係数を求めよ。`;

        const div = document.createElement("div");
        div.className = "question";
        div.innerHTML = `<code>Q${i + 1}:</code> ${questionText}`;
        container.appendChild(div);
      }
    }

    generateQuestions();
  </script>
</body>
</html>
